<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Gloscars - Detalhes do Filme</title>
  <link rel="stylesheet" href="/assets/css/styles.css" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
  <style>

  </style>
<style>
  .password-icon {
    position: absolute;
    right: 16px;
    top: 50%;
    transform: translateY(-50%);
    cursor: pointer;
    font-weight: bold;
    user-select: none;
    width: 22px;
    height: 22px;
  }
  .password-icon g {
    fill: #6f6f6f;
  }
  #login { 
    padding-top: 30px;
  }
</style>
</head>
<body class="bg-black text-white">
<header style="justify-content: center;">
    <a href="login.html"><div class="logo">
        <img src="/assets/img/logo.svg" style="max-width: 180px; filter: brightness(50)">
    </div></a>
</header>

<main>
<section class="content">
    <!-- <div class="catalog">
    </div> -->
  <div id="login">
    <div class="container">
      <div id="login-row" class="row justify-content-center align-items-center">
        <div id="login-column" class="col-md-6">
          <div id="login-box" class="col-md-12">
            <form id="login-form" class="form" method="post" onsubmit="loginUser (this)">
              <h3 class="text-center mb-3">Bem-vindo(a) ao cinema!</h3>
                <div class="form-floating mb-2">
                    <input type="text" class="form-control" id="username" placeholder="nome@email.com">
                    <label for="username">Usuário</label>
                </div>
                <div class="form-floating mb-2">
                    <input type="password" name="password" class="form-control" id="password" placeholder="Sua senha">
                    <label for="password">Senha</label>
                    <svg class="password-icon" id="eye-closed" style="display: block;" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" style="enable-background:new 0 0 512 512" xml:space="preserve"><g><g fill-rule="evenodd" clip-rule="evenodd"><path d="M24.385 14.615a1.5 1.5 0 0 1 2.05.545l2.863 4.938a1.5 1.5 0 0 1-2.596 1.504l-2.862-4.937a1.5 1.5 0 0 1 .545-2.05zM19.015 17.185a1.5 1.5 0 0 1 1.737 1.217l.888 5.038a1.5 1.5 0 1 1-2.955.52l-.887-5.037a1.5 1.5 0 0 1 1.217-1.738zM12.972 17.173a1.5 1.5 0 0 1 1.218 1.737l-.888 5.05a1.5 1.5 0 0 1-2.954-.52l.887-5.05a1.5 1.5 0 0 1 1.737-1.217zM7.6 14.613a1.5 1.5 0 0 1 .55 2.049l-2.863 4.963a1.5 1.5 0 0 1-2.599-1.5l2.863-4.962a1.5 1.5 0 0 1 2.049-.55z" opacity="1"></path><path d="M3.058 11.946a1.5 1.5 0 0 1 2.109.224C7.101 14.565 10.564 17.5 16 17.5s8.899-2.935 10.833-5.33a1.5 1.5 0 1 1 2.334 1.885C26.901 16.86 22.664 20.5 16 20.5S5.1 16.86 2.833 14.055a1.5 1.5 0 0 1 .225-2.11z"></path></g></g></svg>
                    <svg class="password-icon" id="eye-open" style="display: none;" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" style="enable-background:new 0 0 512 512" xml:space="preserve"><g><g fill-rule="evenodd" clip-rule="evenodd"><path d="M4.19 10.44C6.64 7.988 10.5 5.5 16 5.5s9.36 2.489 11.81 4.94a19.425 19.425 0 0 1 2.678 3.354 16.431 16.431 0 0 1 .816 1.454l.046.097.013.03.005.01.001.003.001.001c0 .001 0 .002-1.37.611l1.37.61v.002l-.002.004-.005.01-.013.03a10.909 10.909 0 0 1-.212.427c-.146.277-.36.663-.65 1.123a19.425 19.425 0 0 1-2.677 3.355C25.36 24.01 21.499 26.5 16 26.5s-9.36-2.489-11.81-4.94a19.422 19.422 0 0 1-2.678-3.354 16.465 16.465 0 0 1-.816-1.454 6.637 6.637 0 0 1-.046-.097l-.013-.03-.005-.01-.001-.003-.001-.001c0-.001 0-.002 1.37-.611l-1.37-.61v-.002l.002-.004.005-.01.013-.03.046-.096a16.465 16.465 0 0 1 .816-1.454 19.422 19.422 0 0 1 2.677-3.355zM2 16l-1.37-.61a1.5 1.5 0 0 0 0 1.22zm1.688 0a16.416 16.416 0 0 0 2.622 3.44C8.36 21.488 11.5 23.5 16 23.5s7.64-2.011 9.69-4.06A16.413 16.413 0 0 0 28.311 16a16.413 16.413 0 0 0-2.622-3.44C23.64 10.512 20.5 8.5 16 8.5s-7.64 2.011-9.69 4.06A16.416 16.416 0 0 0 3.689 16zM30 16l1.37.61a1.5 1.5 0 0 0 0-1.22z" opacity="1"></path><path d="M16 13.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5zM10.5 16a5.5 5.5 0 1 1 11 0 5.5 5.5 0 0 1-11 0z" opacity="1"></path></g></g></svg>
                </div>
                <div class="form-group text-end pt-2">                                
                  <input type="submit" name="submit" class="btn btn-primary btn-md" value="Login" style="width: 100%;padding: 15px 30px;font-weight: 600;text-transform: uppercase;letter-spacing: 1px;background: #b38930;border: none;">  
                    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#loginModal" style=" border: 0; width: 100%; margin-top: 10px; background: #000; ">Criar novo usuario</button>
                </div>
              </form>
          </div>  
        </div>
      </div>
    </div>
  </div>    

  <!-- Modal -->
  <div class="modal fade" id="loginModal" tabindex="-1" role="dialog" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title text-dark" id="loginModalLabel">Novo usuário</h5>
          <button type="button" class="btn-close" data-dismiss="modal" aria-label="Close">
          </button>
        </div>
        <div class="modal-body">
            <div id="login-box" class="col-md-12">
                <form id="login-form" class="form" method="post" onsubmit="loginUser (this)">
                    <div class="form-floating mb-2">
                      <input type="text" name="txt_login" id="txt_login" class="form-control" placeholder="nome@email.com">
                      <label for="login">Usuário</label>
                    </div>
                    <div class="form-floating mb-2">
                      <input type="text" name="txt_nome" id="txt_nome" class="form-control" placeholder="João Marcos">
                      <label for="nome">Nome completo</label>
                    </div>
                    <div class="form-floating mb-2">
                      <input type="text" name="txt_email" id="txt_email" class="form-control" placeholder="nome@email.com">
                      <label for="email">E-mail</label>
                    </div>
                    <div class="form-floating mb-2">
                      <input type="password" name="txt_senha" id="txt_senha" class="form-control" placeholder="Senha">
                      <label for="senha">Senha</label>
                    </div>
                    <div class="form-floating mb-2">
                      <input type="password" name="txt_senha2" id="txt_senha2" class="form-control" placeholder="Senha">
                      <label for="senha2">Confirmação de Senha</label>
                    </div>
                </form>
            </div>
        </div>
        <div class="modal-footer" style="display: grid; grid-template-columns: 1fr 2fr; gap: 10px;">
          <button type="button" class="btn btn-secondary" data-dismiss="modal" style="width: 100%">Cancelar</button>
          <button type="button" id="btn_salvar" class="btn btn-primary" style="width: 100%; background: #b38930; border: none !important;">Salvar</button>
        </div>
      </div>
    </div>
  </div>
</section>
</main>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous"/>
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>    
<script src="/assets/js/app.js"></script>
<script src="/assets/js/login.js"></script>
<script>
// Olho senha
document.querySelector('#eye-closed').addEventListener('click', () => {
  const input = document.getElementById('password');
  document.getElementById('password').type = 'text';
  document.querySelector('#eye-open').style.display = "block";
  document.querySelector('#eye-closed').style.display = "none";
});
document.querySelector('#eye-open').addEventListener('click', () => {
  document.getElementById('password').type = 'password';
  document.querySelector('#eye-open').style.display = "none";
  document.querySelector('#eye-closed').style.display = "block";
});
// Declara uma função para processar o formulário de login
function processaFormLogin (event) {                
      // Cancela a submissão do formulário para tratar sem fazer refresh da tela
      event.preventDefault ();

      // Obtem os dados de login e senha a partir do formulário de login
      var username = document.getElementById('username').value;
      var password = document.getElementById('password').value;

      // Valida login e se estiver ok, redireciona para tela inicial da aplicação
      resultadoLogin = loginUser (username, password);
      if (resultadoLogin) {
          window.location.href = 'index.html';
      }
      else { // Se login falhou, avisa ao usuário
          alert ('Usuário ou senha incorretos');
      }
}

function salvaLogin (event) {
  // Cancela a submissão do formulário para tratar sem fazer refresh da tela
  event.preventDefault ();

  // Obtem os dados do formulário
  let login  = document.getElementById('txt_login').value;
  let nome   = document.getElementById('txt_nome').value;
  let email  = document.getElementById('txt_email').value;
  let senha  = document.getElementById('txt_senha').value;
  let senha2 = document.getElementById('txt_senha2').value;
  if (senha != senha2) {
      alert ('As senhas informadas não conferem.');
      return
  }

  // Adiciona o usuário no banco de dados
  addUser (nome, login, senha, email);
  alert ('Usuário salvo com sucesso. Proceda com o login para ');

  // Oculta a div modal do login
  //document.getElementById ('loginModal').style.display = 'none';
  $('#loginModal').modal('hide');
}
// Associa a funçao processaFormLogin  formulário adicionado um manipulador do evento submit
document.getElementById ('login-form').addEventListener ('submit', processaFormLogin);
// Associar salvamento ao botao
document.getElementById ('btn_salvar').addEventListener ('click', salvaLogin);  
</script>
</body>
</html>
